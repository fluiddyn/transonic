python_sources = [
  'bar.py',
  'foo.py',
]

py.install_sources(
  python_sources,
  pure: false,
  subdir: 'package_for_test_meson/__pythran__',
)

bar = custom_target(
    'bar',
    output: ['bar.cpp'],
    input: 'bar.py',
    command: [pythran, '-E', '@INPUT@', '-o', '@OUTDIR@/bar.cpp']
)

bar = py.extension_module(
    'bar',
    bar,
    cpp_args: cpp_args_pythran,
    dependencies: [pythran_dep, np_dep],
    # link_args: version_link_args,
    install: true,
    subdir: 'package_for_test_meson/__pythran__'
)

foo = custom_target(
    'foo',
    output: ['foo.cpp'],
    input: 'foo.py',
    command: [pythran, '-E', '@INPUT@', '-o', '@OUTDIR@/foo.cpp']
)

foo = py.extension_module(
    'foo',
    foo,
    cpp_args: cpp_args_pythran,
    dependencies: [pythran_dep, np_dep],
    # link_args: version_link_args,
    install: true,
    subdir: 'package_for_test_meson/__pythran__'
)
